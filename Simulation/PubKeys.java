package Simulation;

import Nodes.ResourceError;
import java.math.BigInteger;
import java.util.ArrayList;

/**
 * This class contains all of the public information on nodes. In the real world
 * perhaps a 3rd party or some other solution?
 */
public class PubKeys {

    //public diffie hellman g/p
    private static final String G = "128085908549782655492026793906212164982636355847276915910715220180827069277077961252522383342470638566531124808363685193193328955809247740430049503711780688590418453480903863776229527402914546679763523639694661455117719470519861850917053657894025437005509604817749110925222191291065945892764764481295110429213";
    private static final String P = "169203734668386340490005836886921864294303716215468146630045894653095179951847841129783132907370544703105340102767400159837598373062522962610752293502985733333927477826768724106779548773799359105108032422623943367077916008355459311329916556787120087171089654642698105811221897563934670915412890077329683793303";

    //public exponents
    private static final String KDC_PEXP = "7";
    private static final String A_PEXP = "7";
    private static final String B_PEXP = "3";

    //public moduli
    private static final String KDC_PUN = "10624648406352030104540398483971185474786205017415233412872932172367165701094618739806991179744747900219031723438001450476426662519610055612602688390769221363444398185022318994068367812858151403459536706385418639577354848598727369939897495456957194847230560729966975074817438874708124602165019510060717341053426480109278786405762701639070455131182384791480621001942373749891397318041587964269273891777043595030799667269942990236932331682138223789341713691930400126199972663926876992191093441202385700988533466084614446274240842572336937983000977993501848290934864550360161193842754065317813849919844562480169911896199";
    private static final String A_PUN = "25039976173023539350939432462640680793811583645608094914318176923014458363143433148138558764948924468878592060120333573562079947069989099873848344152268656669910330053517787101125426369121511961006887932530944086060136048722219294513926358943162780326572397287475648129613588828672541050060218521905471235274454580064587256303390020931996313988901912456533179176242007608558053964533164544350254124469419398709554172255683160040583072797354526959000040244565606507176850289691768407195468204607346769408258879178989053443709643569441778871440898051707772411108052911976094134731834910071534470372659823442790172055587";
    private static final String B_PUN = "13319423989960578990461473243617030149029717248204259403472730976241583933236667020758929092804776918169361499125566127212669736839923832133632061348821751645884551142583961329093648126135114252928160003856134434452346270928311197310647417527964236768269062658160328382348474127435852952576634649048888505328359427460530862893682803010104112603087628056086266271134135953137958918750747993773658572489258143949867279115401918366521958617713395922630384141468039094802601290158765642959019670450228780107651530042471486073840092881115108057043707661054436002677575136109041318269276744568840993413604909042766732434469";

    //diffie hellman numbers parsed
    public static BigInteger PUBLIC_G = new BigInteger(G);
    public static BigInteger PUBLIC_P = new BigInteger(P);

    //collection for pub keys object
    public ArrayList<pub_info> ALL_INFO;
    
    public final static String Bob = "234";
    public final static String Alice  = "50342";
    public final static String KDC = "392";

    /*
        These constuctors and sub-class/methods give an API to access "Public" information 
     */
    public PubKeys() {
        ALL_INFO = new ArrayList<>();
        ALL_INFO.add(new pub_info(Alice, new BigInteger(A_PEXP), new BigInteger(A_PUN)));
        ALL_INFO.add(new pub_info(Bob, new BigInteger(B_PEXP), new BigInteger(B_PUN)));
        ALL_INFO.add(new pub_info(KDC, new BigInteger(KDC_PEXP), new BigInteger(KDC_PUN)));
    }

    public pub_info get_info(String name) throws ResourceError {
        for (pub_info p : ALL_INFO) {
            if (p.name.equals(name)) {
                return p;
            }
        }
        throw new ResourceError("User not found : " + name);
    }

    public class pub_info {

        public pub_info(String name, BigInteger public_exponent, BigInteger public_modulus) {
            this.public_exponent = public_exponent;
            this.public_modulus = public_modulus;
            this.name = name;
        }
        public BigInteger public_exponent;
        public BigInteger public_modulus;
        public String name;

    }
}
